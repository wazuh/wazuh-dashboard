FROM debian:bookworm-slim

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update \
    && apt-get install -y --no-install-recommends \
       bash \
       ca-certificates \
       coreutils \
       jq \
       python3 \
       python3-pip \
       python3-yaml \
       bats \
       git \
       grep \
       sed \
       gawk \
       findutils \
    && rm -rf /var/lib/apt/lists/*

# Install the Python-based yq (kislyuk/yq) which is not Mike Farah's
RUN pip3 install --no-cache-dir yq \
    && yq --version || true

# Ensure yq is on PATH for all shells
RUN ln -sf /usr/local/bin/yq /usr/bin/yq || true

WORKDIR /workspace
